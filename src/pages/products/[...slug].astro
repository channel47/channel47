---
// src/pages/products/[...slug].astro
import { getCollection } from 'astro:content';
import ProductPage from '../../layouts/ProductPage.astro';

export async function getStaticPaths() {
  const products = await getCollection('products', ({ data }) => !data.draft);
  return products.map((product) => ({
    params: { slug: product.slug },
    props: { product },
  }));
}

const { product } = Astro.props;
const { Content } = await product.render();
---
<ProductPage
  title={product.data.title}
  description={product.data.description}
  category={product.data.category}
  author={product.data.author}
  authorUrl={product.data.authorUrl}
  sourceUrl={product.data.sourceUrl}
  featured={product.data.featured}
>
  <Content />
</ProductPage>
