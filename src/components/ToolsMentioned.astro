---
// src/components/ToolsMentioned.astro
import mergedPlugins from '../data/merged-plugins.json';

interface Props {
  tools: Array<{
    slug: string;
    source: 'channel47' | 'external';
    installCommand?: string;
  }>;
}

const { tools } = Astro.props;

const enrichedTools = tools.map(tool => {
  if (tool.source === 'channel47') {
    const pluginData = mergedPlugins.find(p => p.name === tool.slug);
    return {
      ...tool,
      name: pluginData?.name || tool.slug,
      description: pluginData?.description,
      url: `/plugins/${tool.slug}`,
    };
  }
  return {
    ...tool,
    name: tool.slug,
    description: undefined,
    url: null,
  };
});
---

<div>
  <h2 class="section-header">Tools Mentioned</h2>
  <ul class="related-list">
    {enrichedTools.map(tool => (
      <li class="related-list__item">
        {tool.url ? (
          <a href={tool.url} class="related-list__link">
            {tool.name}
          </a>
        ) : (
          <span style="color: var(--color-text);">{tool.name}</span>
        )}
        {tool.description && (
          <span style="font-size: var(--text-sm); color: var(--color-text-muted); margin-left: var(--space-2);">
            â€” {tool.description}
          </span>
        )}
      </li>
    ))}
  </ul>
</div>
